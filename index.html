<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VerbeMente - Italian to Spanish</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            min-height: 100vh;
            color: #ffffff;
        }

        .card-3d {
            perspective: 2500px;
            height: 500px;
            margin-bottom: 2rem;
        }

        .card-inner {
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
            position: relative;
            width: 100%;
            height: 100%;
        }

        .card-inner.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 1.5rem;
            background: rgba(30, 41, 59, 0.95);
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(99, 102, 241, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-back {
            transform: rotateY(180deg);
        }

        .progress-bar {
            height: 4px;
            background: rgba(99, 102, 241, 0.2);
            border-radius: 2px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #818cf8;
            transition: width 0.3s ease;
        }

        .conjugation-table {
            background: rgba(30, 41, 59, 0.95);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 1rem;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .nav-button {
            transition: all 0.2s ease;
            background: rgba(30, 41, 59, 0.95);
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .nav-button:hover {
            transform: scale(1.05);
            background: rgba(99, 102, 241, 0.2);
        }

        .score-button {
            transition: all 0.2s ease;
        }

        .score-button:hover {
            transform: translateY(-2px);
        }

        .session-info {
            font-family: monospace;
            color: #818cf8;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const cardsData = [
            {
                spanish: "ser",
                italian: "essere",
                meaning: "to be (permanent)",
                irregular: true,
                conjugation: {
                    yo: "soy",
                    tú: "eres",
                    él_ella: "es",
                    nosotros: "somos",
                    vosotros: "sois",
                    ellos_ellas: "son"
                }
            },
            // ... rest of your cards data
        ];

        function App() {
            const [currentIndex, setCurrentIndex] = useState(0);
            const [isFlipped, setIsFlipped] = useState(false);
            const [sessionCards, setSessionCards] = useState(() => {
                // Shuffle and select 20 cards for the session
                const shuffled = [...cardsData].sort(() => Math.random() - 0.5);
                return shuffled.slice(0, 20);
            });
            const [isTransitioning, setIsTransitioning] = useState(false);

            const nextCard = () => {
                if (isTransitioning) return;
                setIsTransitioning(true);
                setIsFlipped(false);
                
                // Wait for flip animation to complete before changing card
                setTimeout(() => {
                    setCurrentIndex((prev) => (prev + 1) % sessionCards.length);
                    setIsTransitioning(false);
                }, 800); // Match the CSS transition duration
            };

            const prevCard = () => {
                if (isTransitioning) return;
                setIsTransitioning(true);
                setIsFlipped(false);
                
                setTimeout(() => {
                    setCurrentIndex((prev) => (prev - 1 + sessionCards.length) % sessionCards.length);
                    setIsTransitioning(false);
                }, 800);
            };

            useEffect(() => {
                const handleKeyPress = (e) => {
                    if (isTransitioning) return;
                    if (e.key === 'ArrowRight') {
                        e.preventDefault();
                        nextCard();
                    } else if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        prevCard();
                    } else if (e.key === ' ') {
                        e.preventDefault();
                        setIsFlipped(prev => !prev);
                    }
                };

                window.addEventListener('keydown', handleKeyPress);
                return () => window.removeEventListener('keydown', handleKeyPress);
            }, [isTransitioning]);

            const handleScore = (score) => {
                const cardId = sessionCards[currentIndex].spanish;
                const now = new Date().toISOString();
                
                const scores = JSON.parse(localStorage.getItem('verbeMenteScores') || '{}');
                scores[cardId] = {
                    score: score,
                    lastSeen: now,
                    timesReviewed: (scores[cardId]?.timesReviewed || 0) + 1
                };
                localStorage.setItem('verbeMenteScores', JSON.stringify(scores));
                
                nextCard();
            };

            const currentCard = sessionCards[currentIndex];
            const progress = ((currentIndex + 1) / sessionCards.length) * 100;

            return (
                <div className="container mx-auto px-4 py-8">
                    <div className="text-center mb-8">
                        <h1 className="text-6xl font-bold mb-3 text-indigo-400">
                            VerbeMente
                        </h1>
                        <p className="text-gray-400 text-lg mb-4">Italian to Spanish Verbs</p>
                        <div className="progress-bar">
                            <div className="progress-fill" style={{ width: `${progress}%` }}></div>
                        </div>
                        <p className="session-info">Card {currentIndex + 1} of {sessionCards.length}</p>
                    </div>

                    <div className="flex justify-center gap-6 mb-8">
                        <button 
                            className="nav-button p-4 rounded-full text-white shadow-lg hover:shadow-xl text-2xl"
                            onClick={prevCard}
                            disabled={isTransitioning}
                        >
                            ←
                        </button>
                        <button 
                            className="nav-button p-4 rounded-full text-white shadow-lg hover:shadow-xl text-2xl"
                            onClick={nextCard}
                            disabled={isTransitioning}
                        >
                            →
                        </button>
                    </div>

                    <div className="max-w-2xl mx-auto card-3d" onClick={() => !isTransitioning && setIsFlipped(!isFlipped)}>
                        <div className={`card-inner h-full ${isFlipped ? 'flipped' : ''}`}>
                            <div className="card-face p-8">
                                <div className="text-center">
                                    <h2 className="text-6xl font-bold mb-6 text-indigo-400">
                                        {currentCard.italian}
                                    </h2>
                                    <p className="text-gray-400">Click to reveal Spanish translation</p>
                                </div>
                            </div>

                            <div className="card-face card-back p-8">
                                <div className="text-center">
                                    <h2 className="text-4xl font-bold mb-2 text-indigo-400">
                                        {currentCard.spanish}
                                    </h2>
                                    <p className="text-xl text-gray-300 mb-4">{currentCard.meaning}</p>
                                    
                                    {currentCard.irregular && (
                                        <div className="conjugation-table">
                                            <div className="flex justify-center mb-4">
                                                <span className="px-4 py-1 bg-red-500 text-white text-sm rounded-full font-medium">
                                                    Irregular Verb
                                                </span>
                                            </div>
                                            <div className="grid grid-cols-2 gap-8">
                                                <div>
                                                    <div className="conjugation-row">
                                                        <span className="text-gray-400">yo</span>
                                                        <span className="text-xl font-medium">{currentCard.conjugation.yo}</span>
                                                    </div>
                                                    <div className="conjugation-row">
                                                        <span className="text-gray-400">tú</span>
                                                        <span className="text-xl font-medium">{currentCard.conjugation.tú}</span>
                                                    </div>
                                                    <div className="conjugation-row">
                                                        <span className="text-gray-400">él/ella</span>
                                                        <span className="text-xl font-medium">{currentCard.conjugation.él_ella}</span>
                                                    </div>
                                                </div>
                                                <div>
                                                    <div className="conjugation-row">
                                                        <span className="text-gray-400">nosotros</span>
                                                        <span className="text-xl font-medium">{currentCard.conjugation.nosotros}</span>
                                                    </div>
                                                    <div className="conjugation-row">
                                                        <span className="text-gray-400">vosotros</span>
                                                        <span className="text-xl font-medium">{currentCard.conjugation.vosotros}</span>
                                                    </div>
                                                    <div className="conjugation-row">
                                                        <span className="text-gray-400">ellos/ellas</span>
                                                        <span className="text-xl font-medium">{currentCard.conjugation.ellos_ellas}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    )}

                                    <div className="flex gap-3 mt-6 justify-center">
                                        <button 
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                handleScore(1);
                                            }}
                                            className="score-button px-6 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium shadow-md"
                                            disabled={isTransitioning}
                                        >
                                            Again
                                        </button>
                                        <button 
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                handleScore(2);
                                            }}
                                            className="score-button px-6 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg font-medium shadow-md"
                                            disabled={isTransitioning}
                                        >
                                            Hard
                                        </button>
                                        <button 
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                handleScore(3);
                                            }}
                                            className="score-button px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium shadow-md"
                                            disabled={isTransitioning}
                                        >
                                            Good
                                        </button>
                                        <button 
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                handleScore(4);
                                            }}
                                            className="score-button px-6 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-medium shadow-md"
                                            disabled={isTransitioning}
                                        >
                                            Easy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
